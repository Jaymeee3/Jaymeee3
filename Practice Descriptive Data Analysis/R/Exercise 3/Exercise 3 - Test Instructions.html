<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>R and MySQL Test</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      line-height: 1.6;
      background-color: #ffffff;
      display: flex;
      justify-content: center;
    }

    .container {
      max-width: 900px;
      padding: 30px;
      margin: 40px auto;
      text-align: left;
    }

    pre {
      background-color: #f8f9fa;
      padding: 15px;
      border: 1px solid #ccc;
      border-radius: 5px;
      overflow-x: auto;
      font-family: Consolas, monospace;
      font-size: 14px;
      text-align: left;
    }

    ul, ol {
      padding-left: 20px;
    }

    li {
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <div class="container">

    <h1 style="color: darkblue;">Test Instructions:</h1>
    <p>
      The test consists of several tasks—complete as many as possible.<br>
      Complete the R section using an Rmarkdown file, and the MySQL section using MySQL Workbench.
    </p>

    <h3 style="color: darkblue;">Task Info:</h3>
    <ul>
      <li>Some tasks may depend on the results of previous ones;</li>
      <li>Copy the number and description of each task before starting it, to clearly indicate which task you're working on;</li>
      <li>The code must be commented, since the interpretation of the results is subject to evaluation. Moreover, comments are useful because even if the expected results are not obtained, it will still be possible to evaluate whether the approach was close to the solution.</li>
    </ul>

    <h4 style="color: darkblue;">R Section – Task List</h4>
    <ol>
      <li>Import the dataset <code>MoviesOnStreamingPlatforms.csv</code> (note: the separator is a comma), which contains information about movies and TV series available on various streaming platforms (see metadata). Create a copy of the dataset and name it <code>movies</code>.</li>

      <li>Before working with the dataset, clean it. Rewrite the last two code chunks into a single one using the tidyverse programming paradigm (i.e., using <code>mutate</code> and <code>pipelines</code>), and run it. If you're unable to do so, simply run the existing code.</li>

      <pre><code># names(movies) = str_to_lower(names(movies))

### rewrite the code starting from here: ###
# movies$rotten.tomatoes = str_replace(movies$rotten.tomatoes, '/100', '')
# 
# movies = movies %>% rename(review_score = rotten.tomatoes,
#                            prime_video = prime.video,
#                            disney_plus = disney.) %>%
#   select(-x)
</code></pre>

      <li>Check whether the data types of the imported variables were correctly detected, and explain for which variables a type casting operation would be necessary.</li>

      <li>The variables <code>netflix</code>, <code>hulu</code>, <code>prime_video</code>, and <code>disney_plus</code> indicate whether a movie is available on the corresponding platform. Create a new variable <code>platform_sum</code> that counts how many platforms each movie is available on.</li>

      <li>Graphically visualize the new variable <code>platform_sum</code> and provide comments.</li>

      <li>Extract the titles of the 8 movies available on the most platforms.</li>

      <li>Assume that the availability of a movie on Netflix (<code>netflix</code>) affects the review score (<code>review_score</code>, previously called <code>rotten.tomatoes</code>). Visualize the relationship between the variables and comment (hint: <code>netflix</code> can be treated as a categorical variable).</li>

      <li>Try to replicate the visualization for movies rated 16+ and released before 2018 (<code>age</code> and <code>year</code>). Provide comments.</li>
    </ol>

    <h4 style="color: darkblue;">MySQL Section – Task List</h4>
    <ol>
      <li>Consider the <code>clienti</code> table. Count the number of customers with at least one active energy service (<code>serviziattivi</code> field).</li>

      <li>Consider the <code>SurveyIngresso</code> table. The goal is to analyze the differences between users with a master’s degree (<code>titolo_studio</code> field) and all others. Create a new field <code>flag_laurea_magistrale</code> indicating whether the user has a master’s degree or not. Insert the result into a temporary table.</li>

      <li>Analyze the following query. Describe the relationships between the tables and whether the join is properly defined. If not, identify and explain the errors, and correct them.</li>

      <pre><code>select i.*
       ,si.titolo_studio
       ,si.studente_universitario
from mydemo.iscrizione i
left join mydemo.SurveyIngresso si on i.fkcorso = si.fkcorso;
</code></pre>

      <li>Consider the <code>ente</code> table. Starting from it, perform an <code>inner join</code> with the <code>utente</code> table. Describe the relationships between the tables and identify the unit of analysis.</li>
    </ol>

  </div>
</body>
</html>
